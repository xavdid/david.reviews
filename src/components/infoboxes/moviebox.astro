---
import { Image } from "astro:assets";

import MovieIcon from "../icons/movie.astro";
import Rating from "../rating.astro";

type Props = {
  title: string;
  rating: number;
  watchedOn: string;
  posterUrl: string;
  notes: string;
  numWatch: number;
  isFirstWatch: boolean;
  tmdbId: string;
  award?: string;
  collections?: string[];
};
const {
  title,
  rating,
  watchedOn,
  posterUrl,
  notes,
  numWatch,
  isFirstWatch,
  tmdbId,
  award,
  collections,
} = Astro.props;
---

<div class="mb-6 flex rounded border-2 border-red-500 even:bg-red-50">
  <div class="p-2">
    <Image
      src={posterUrl}
      alt={`poster for ${title}`}
      height={187.5}
      width={125}
    />
  </div>

  <div class="flex w-full flex-col justify-between">
    <div class="flex justify-between border-b-2 border-l-2 border-red-500 pl-2">
      <a href={`/movies/${tmdbId}`}>
        <h3 class="text-l font-bold underline hover:bg-slate-300">
          {title}
        </h3></a
      >
      <div>
        {award && <div class="inline pr-2">ðŸ¥‡</div>}
        {
          collections &&
            collections.map((collection) => (
              <div class="inline pr-2">{collection.split(" ")[0]}</div>
            ))
        }
        <MovieIcon classes="pb-[0.10em] inline h-6 fill-red-500 pr-1" />
      </div>
    </div>
    <p class="px-4 py-2">
      {notes ?? <em>no review</em>}
    </p>
    <div class="flex justify-between border-l-2 border-t-2 border-red-500 px-2">
      <div class="">
        <span class="hidden md:inline">Watched on:{" "}</span>{watchedOn}
      </div>
      <span>Watch #{numWatch}{numWatch === 1 && !isFirstWatch && "*"}</span>
      <Rating rating={rating} />
    </div>
  </div>
</div>
